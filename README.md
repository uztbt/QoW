# ワインの品質当て
> 弟「学校で課題が出たんだけど、解けるなら解いてみて」

ゴールデンウィーク中暇だったので解いてみました。
_（注意）訓練データは著作権に配慮して非公開とします。_

## 問題
訓練データとしてワインの性質と品質の表が与えられる。  
テストデータのワインの性質から、その品質を推測せよ。  
性質：phなど11項目  
品質: 1から10の10段階？(訓練ファイルには3から8までしか存在しなかった）  

## 解答方針
* ディープラーニングが使える
* 多クラス分類問題として考える

## 解答までの手順
1. 引っ越しの際に売り払ってしまった[『ゼロから作るDeep Learning』]
(https://www.amazon.co.jp/%E3%82%BC%E3%83%AD%E3%81%8B%E3%82%89%E4%BD%9C%E3%82%8BDeep-Learning-%E2%80%95Python%E3%81%A7%E5%AD%A6%E3%81%B6%E3%83%87%E3%82%A3%E3%83%BC%E3%83%97%E3%83%A9%E3%83%BC%E3%83%8B%E3%83%B3%E3%82%B0%E3%81%AE%E7%90%86%E8%AB%96%E3%81%A8%E5%AE%9F%E8%A3%85-%E6%96%8E%E8%97%A4-%E5%BA%B7%E6%AF%85/dp/4873117585)
の記憶を頼りに自力で(ゼロから)解く
2. あんまり思い出せず、挫折
3. pythonのディープラーニング用のライブラリを探す
4. Kerasというライブラリを見つける
5. [『入門 Keras』]
(https://www.infiniteloop.co.jp/blog/2017/12/learning-keras-02/)
を参考にディープラーニングを復習
6. 解答([esp_taster.py](esp_taster.py))を作成  

途中、[Numpy tutorial]
(http://cs231n.github.io/python-numpy-tutorial/)
を使って必要な知識を補った。

## esp_taster.py
* モデルに訓練データを5000回学習させる
* 最後にモデルの評価を行う
* 隠れ層は３層で、それぞれ32,24,16ユニット保持している
* 隠れ層の活性化関数はrelu、出力層の活性化関数はsoftmaxである
* [損失関数は多クラス分類問題に適しているcategorical_crossentropy]
(http://kinokoru.jp/archives/1470)
である
* 最適化手法はSGDである

## 評価
```
Number of epochs: 5000
Number of correct predictions: 858/1119
Accuracy: 0.7667560321715817
```

## プログラム動作時の注意
```
hoge/
┝esp_taster.py
┝winedata/train.csv
```
というディレクトリ構成にされたい。
著作権に配慮してwindedata/ディレクトリを公開することは避けた。

## まとめ
自分はディープラーニングについて浅い知識しか持っていない。  
それでも、7割以上の確率でワインの品質をピッタリ当てられた。  
すごいことだと思うと同時に、７割ではとても使えるクォリティではないことは確かである。  
今後ディープラーニングについて学習をする場合、ここがスタート地点になると思う。  
今回はその足固めができた。  

## 書き残しておくこと
* 隠れ層の設定や学習回数は恣意的であり、理論やベストプラクティスに基づいたものではない
* モデルの評価方法が甘い。本来[10-fold cross-validation]
(https://www.openml.org/a/estimation-procedures/1)
などを用いて行われるべきである  

また、ファイル名esp_taster.pyのespはエスパーから。  
